!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("phylocanvas"));else if("function"==typeof define&&define.amd)define(["phylocanvas"],t);else{var a=t("object"==typeof exports?require("phylocanvas"):e.phylocanvas);for(var r in a)("object"==typeof exports?exports:e)[r]=a[r]}}(this,function(e){return function(e){function t(r){if(a[r])return a[r].exports;var n=a[r]={exports:{},id:r,loaded:!1};return e[r].call(n.exports,n,n.exports,t),n.loaded=!0,n.exports}var a={};return t.m=e,t.c=a,t.p="",t(0)}([function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function n(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}return Array.from(e)}function l(e){return"circular"===e.treeType||"radial"===e.treeType}function i(e){return e.metadata.font?e.metadata.font:Math.min(e.textSize,e.metadata.blockLength)+"pt "+e.font}function o(e){var t=e.metadata,a=t.columns,r=t.propertyName;return a.length>0?a:Object.keys(e.leaves[0][r])}function d(e){var t=e.metadata,a=t.showLabels,r=t.blockLength,n=t.padding,l=t._maxLabelWidth,i=o(e);return(a?i.reduce(function(e,t){return l[t]},0):0)+i.length*(r+n)}function c(e){if(e.metadata._maxBlockSize)return e.metadata._maxBlockSize;if(l(e)){var t=0,a=!0,r=!1,n=void 0;try{for(var i,o=e.leaves[Symbol.iterator]();!(a=(i=o.next()).done);a=!0){var d=i.value,c=d.getLabelStartX();(e.showLabels||e.hoverLabel&&d.highlighted)&&(c+=e.maxLabelLength[e.treeType]);var s=e.alignLabels?e.labelAlign.getLabelOffset(d):0,h=Math.hypot(d.centerx-d.startx,d.centery-d.starty)+c+s;h>t&&(t=h)}}catch(e){r=!0,n=e}finally{try{!a&&o.return&&o.return()}finally{if(r)throw n}}return e.metadata._maxBlockSize=g.FULL*t/e.leaves.length,e.metadata._maxBlockSize}return e.step}function s(e,t,a){console.log("Drawing column header");var r=e.tree.canvas,n=e.tree.treeType,l=e.tree.metadata,o=l._maxLabelWidth,d=l._maxHeaderWidth,c=l._maxHeaderHeight,s=l.blockLength,h=l.padding,f=l.headerAngle,u=l.showLabels,y=l.fillStyle,v=l.strokeStyle,m=l.underlineHeaders,b=e.tree.metadata.columns.length>0?e.tree.metadata.columns:Object.keys(e.data),g=e.tree.metadata.lineWidth/e.tree.zoom;r.font=i(e.tree),r.fillStyle=y,r.strokeStyle=v,r.lineWidth=g;var p=f/180*Math.PI,x=a+c+Math.sin(p)*d/2,L="hierarchical"===n?-1:1,_=t,S=!0,w=!1,k=void 0;try{for(var T,A=b[Symbol.iterator]();!(S=(T=A.next()).done);S=!0){var H=T.value,M=s+(u?o[H]:0);r.textAlign="center",r.textBaseline="middle";var W=_;r.rotate(-p),r.font("bold"),r.fillText(H,Math.cos(p)*W+Math.sin(p)*L*x,Math.sin(p)*W+Math.cos(p)*-L*x),r.rotate(p),m&&(r.beginPath(),r.moveTo(_,-L*a),r.lineTo(_+M,-L*a),r.stroke(),r.closePath()),_+=M+h}}catch(e){w=!0,k=e}finally{try{!S&&A.return&&A.return()}finally{if(w)throw k}}}function h(e){var t=e.tree.canvas,a=e.tree,r=e.tree.metadata,n=r._maxLabelWidth,o=r.blockSize,d=r.blockLength,h=r.padding,f=r.propertyName,u=r.fillStyle,y=r.columns,v=r.showLabels,m=h/4,b=a.alignLabels;a.alignLabels=!0;var p=e.getLabelStartX()+a.maxLabelLength[a.treeType],x=0,L=c(a),_=null!==o?Math.min(L,o):L,S=_/2;a.alignLabels&&(p+=a.labelAlign.getLabelOffset(e)),a.alignLabels=b,p+=h,x-=S,a.metadata._headingDrawn||(s(e,p,S+h),a.metadata._headingDrawn=!0);var w=this[f];if(Object.keys(w).length>0){t.beginPath();var k=y.length>0?y:Object.keys(w),T=1,A=l(a)&&a.alignLabels?g.FULL*d/a.leaves.length:0;t.font=i(a);var H=!0,M=!1,W=void 0;try{for(var j,B=k[Symbol.iterator]();!(H=(j=B.next()).done);H=!0){var z=j.value,O=w[z];if("undefined"!=typeof O&&"transparent"!==e.leafStyle.fillStyle&&(O.colour&&(t.fillStyle=O.colour,t.fillRect(p,x,d,_+T*A)),v&&"string"==typeof w[z].label)){var P=p+m+(O.colour?d:0);t.fillStyle=u,t.textAlign="center",t.textBaseline="middle",t.fillText(O.label,P,x+S)}p+=d+h,v&&(p+=n[z]),T++}}catch(e){M=!0,W=e}finally{try{!H&&B.return&&B.return()}finally{if(M)throw W}}t.closePath()}}function f(e){var t=e.canvas,a=e.metadata,r=a.showLabels,n=a.propertyName,l=a.headerAngle,d=o(e),c=l/180*Math.PI;t.font=i(e),e.metadata._maxHeaderWidth=0,e.metadata._maxHeaderHeight=t.measureText("M").width;var s={};if(r){var h=!0,f=!1,u=void 0;try{for(var y,v=d[Symbol.iterator]();!(h=(y=v.next()).done);h=!0){var m=y.value,b=t.measureText(m).width;s[m]=Math.cos(c)*b,b>e.metadata._maxHeaderWidth&&(e.metadata._maxHeaderWidth=b)}}catch(e){f=!0,u=e}finally{try{!h&&v.return&&v.return()}finally{if(f)throw u}}var g=!0,p=!1,x=void 0;try{for(var L,_=e.leaves[Symbol.iterator]();!(g=(L=_.next()).done);g=!0){var S=L.value,w=S[n],k=!0,T=!1,A=void 0;try{for(var H,M=d[Symbol.iterator]();!(k=(H=M.next()).done);k=!0){var W=H.value;if(w[W]&&"string"==typeof w[W].label){var j=t.measureText(w[W].label).width;j>s[W]&&(s[W]=j)}}}catch(e){T=!0,A=e}finally{try{!k&&M.return&&M.return()}finally{if(T)throw A}}}}catch(e){p=!0,x=e}finally{try{!g&&_.return&&_.return()}finally{if(p)throw x}}}else{var B=!0,z=!1,O=void 0;try{for(var P,D=d[Symbol.iterator]();!(B=(P=D.next()).done);B=!0){var N=P.value;s[N]=0}}catch(e){z=!0,O=e}finally{try{!B&&D.return&&D.return()}finally{if(z)throw O}}}e.metadata._maxLabelWidth=s}function u(e){e(m.default,"createTree",function(e,t){var a=e.apply(void 0,n(t));return a.metadata=Object.assign({},p,a.metadata||{}),a});var t=v.Tree.prototype.__lookupGetter__("alignLabels");v.Tree.prototype.__defineGetter__("alignLabels",function(){return this.metadata.active?this.labelAlign&&this.labelAlignEnabled:t.call(this)}),e(v.Prerenderer,"run",function(e,t){e.apply(this,t);var a=y(t,1),r=a[0];f(r),r.metadata._maxBlockSize=null}),e(v.Tree,"draw",function(e,t){this.metadata.active&&(this.metadata._headingDrawn=!1),e.apply(this,t)}),e(v.Tree,"getBounds",function(e,t){var a=e.apply(this,t);if(this.metadata.active){var r=a[0][0],n=a[0][1],l=a[1][0],i=a[1][1],o=this.metadata,d=o._maxHeaderWidth,c=o._maxHeaderHeight,s=this.treeType,h="rectangular"===s||"diagonal"===s,f="hierarchical"===s;return[[r-(f?d+c:0),n-(h?d+c:0)],[l,i]]}return a}),e(v.Branch,"drawLeaf",function(e){e.call(this),this.tree.metadata.active&&h.call(this,this)}),e(v.Branch,"getTotalLength",function(e){var t=e.call(this);return this.tree.metadata.active&&(t+=d(this.tree)),t})}Object.defineProperty(t,"__esModule",{value:!0});var y=function(){function e(e,t){var a=[],r=!0,n=!1,l=void 0;try{for(var i,o=e[Symbol.iterator]();!(r=(i=o.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(e){n=!0,l=e}finally{try{!r&&o.return&&o.return()}finally{if(n)throw l}}return a}return function(t,a){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,a);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.default=u;var v=a(1),m=r(v),b=v.utils.constants,g=b.Angles,p={_headingDrawn:!1,_maxLabelWidth:{},active:!0,showHeaders:!0,showLabels:!0,blockLength:32,blockSize:null,padding:8,columns:[],propertyName:"data",underlineHeaders:!0,headerAngle:90,fillStyle:"black",strokeStyle:"black",lineWidth:1,font:null}},function(t,a){t.exports=e}])});